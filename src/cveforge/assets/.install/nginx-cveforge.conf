server {{
    server_name cveforge.localhost;
    listen 80;
    listen [::]:80;

    location /static/ {{
        alias {STATIC_ROOT}/;
        autoindex off;
        access_log off;

        # Serve files efficiently and cache aggressively
        try_files $uri $uri/ =404;
        expires 30d;
        add_header Cache-Control "public, max-age=2592000, immutable";
    }}
    location /media/ {{
        alias {MEDIA_ROOT}/;
        autoindex off;

        # No aggressive caching for media files (they may change)
        try_files $uri $uri/ =404;
        expires 1h;
        add_header Cache-Control "public, max-age=3600";
    }}

    location / {{
        proxy_pass http://localhost:{TCP_MAIN_PORT};
        # Preserve real client info
        proxy_set_header Host              $host;
        proxy_set_header X-Real-IP         $remote_addr;
        proxy_set_header X-Forwarded-For   $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # Better timeouts for ASGI/WSGI apps
        proxy_connect_timeout   5s;
        proxy_send_timeout     120s;
        proxy_read_timeout     300s;

        # Reduce buffering for streaming / SSE / websockets-like behavior
        proxy_buffering off;
    }}
}}