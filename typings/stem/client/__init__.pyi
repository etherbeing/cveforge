"""
This type stub file was generated by pyright.
"""

import hashlib
import threading
import stem
import stem.client.cell
import stem.socket
import stem.util.connection
from stem.client.cell import CELL_TYPE_SIZE, Cell, FIXED_PAYLOAD_LEN
from stem.client.datatype import Address, KDF, LinkProtocol, RelayCommand, ZERO, split

"""
Interaction with a Tor relay's ORPort. :class:`~stem.client.Relay` is
a wrapper for :class:`~stem.socket.RelaySocket`, much the same way as
:class:`~stem.control.Controller` provides higher level functions for
:class:`~stem.socket.ControlSocket`.

.. versionadded:: 1.7.0

::

  Relay - Connection with a tor relay's ORPort.
    | +- connect - Establishes a connection with a relay.
    |
    |- is_alive - reports if our connection is open or closed
    |- connection_time - time when we last connected or disconnected
    |- close - shuts down our connection
    |
    +- create_circuit - establishes a new circuit

  Circuit - Circuit we've established through a relay.
    |- send - sends a message through this circuit
    +- close - closes this circuit
"""
__all__ = ['cell', 'datatype']
DEFAULT_LINK_PROTOCOLS = ...
class Relay:
  """
  Connection with a Tor relay's ORPort.

  :var int link_protocol: link protocol version we established
  """
  def __init__(self, orport, link_protocol) -> None:
    ...
  
  @staticmethod
  def connect(address, port, link_protocols=...): # -> Relay:
    """
    Establishes a connection with the given ORPort.

    :param str address: ip address of the relay
    :param int port: ORPort of the relay
    :param tuple link_protocols: acceptable link protocol versions

    :raises:
      * **ValueError** if address or port are invalid
      * :class:`stem.SocketError` if we're unable to establish a connection
    """
    ...
  
  def is_alive(self):
    """
    Checks if our socket is currently connected. This is a pass-through for our
    socket's :func:`~stem.socket.BaseSocket.is_alive` method.

    :returns: **bool** that's **True** if our socket is connected and **False** otherwise
    """
    ...
  
  def connection_time(self):
    """
    Provides the unix timestamp for when our socket was either connected or
    disconnected. That is to say, the time we connected if we're currently
    connected and the time we disconnected if we're not connected.

    :returns: **float** for when we last connected or disconnected, zero if
      we've never connected
    """
    ...
  
  def close(self):
    """
    Closes our socket connection. This is a pass-through for our socket's
    :func:`~stem.socket.BaseSocket.close` method.
    """
    ...
  
  def create_circuit(self): # -> Circuit:
    """
    Establishes a new circuit.
    """
    ...
  
  def __iter__(self): # -> Generator[Any, Any, None]:
    ...
  
  def __enter__(self): # -> Self:
    ...
  
  def __exit__(self, exit_type, value, traceback): # -> None:
    ...
  


class Circuit:
  """
  Circuit through which requests can be made of a `Tor relay's ORPort
  <https://gitweb.torproject.org/torspec.git/tree/tor-spec.txt>`_.

  :var stem.client.Relay relay: relay through which this circuit has been established
  :var int id: circuit id
  :var hashlib.sha1 forward_digest: digest for forward integrity check
  :var hashlib.sha1 backward_digest: digest for backward integrity check
  :var bytes forward_key: forward encryption key
  :var bytes backward_key: backward encryption key
  """
  def __init__(self, relay, circ_id, kdf) -> None:
    ...
  
  def directory(self, request, stream_id=...): # -> bytes:
    """
    Request descriptors from the relay.

    :param str request: directory request to make
    :param int stream_id: specific stream this concerns

    :returns: **str** with the requested descriptor data
    """
    ...
  
  def close(self): # -> None:
    ...
  
  def __enter__(self): # -> Self:
    ...
  
  def __exit__(self, exit_type, value, traceback): # -> None:
    ...
  


