"""
This type stub file was generated by pyright.
"""

from typing import Tuple, Union
from bip_utils.bip.bip38.bip38_addr import Bip38PubKeyModes
from bip_utils.ecc import IPrivateKey

"""
Module for BIP38 encryption/decryption.
Reference: https://github.com/bitcoin/bips/blob/master/bip-0038.mediawiki
"""
class Bip38NoEcConst:
    """Class container for BIP38 no EC constants."""
    ENC_KEY_BYTE_LEN: int = ...
    ENC_KEY_PREFIX: bytes = ...
    FLAGBYTE_COMPRESSED: bytes = ...
    FLAGBYTE_UNCOMPRESSED: bytes = ...
    SCRYPT_KEY_LEN: int = ...
    SCRYPT_N: int = ...
    SCRYPT_P: int = ...
    SCRYPT_R: int = ...


class _Bip38NoEcUtils:
    """Class container for BIP38 no EC utility functions."""
    @staticmethod
    def AddressHash(priv_key_bytes: bytes, pub_key_mode: Bip38PubKeyModes) -> bytes:
        """
        Compute the address hash as specified in BIP38 (without EC multiplication).

        Args:
            priv_key_bytes (bytes)         : private key bytes
            pub_key_mode (Bip38PubKeyModes): Public key mode

        Returns:
            bytes: Address hash

        Raises:
            ValueError: If the private key is not valid
        """
        ...
    
    @staticmethod
    def DeriveKeyHalves(passphrase: str, address_hash: bytes) -> Tuple[bytes, bytes]:
        """
        Compute the scrypt as specified in BIP38 (without EC multiplication) and derive the two key halves.

        Args:
            passphrase (str)    : Passphrase
            address_hash (bytes): Address hash

        Returns:
            tuple[bytes, bytes]: Derived key halves
        """
        ...
    


class Bip38NoEcEncrypter:
    """
    BIP38 encrypter class.
    It encrypts a private key using the algorithm specified in BIP38 without EC multiplication.
    """
    @staticmethod
    def Encrypt(priv_key: Union[bytes, IPrivateKey], passphrase: str, pub_key_mode: Bip38PubKeyModes) -> str:
        """
        Encrypt the specified private key.

        Args:
            priv_key (bytes or IPrivateKey): Private key bytes or object
            passphrase (str)               : Passphrase
            pub_key_mode (Bip38PubKeyModes): Public key mode

        Returns:
            str: Encrypted private key

        Raises:
            TypeError: If the private key is not a Secp256k1PrivateKey
            ValueError: If the private key bytes are not valid
        """
        ...
    


class Bip38NoEcDecrypter:
    """
    BIP38 decrypter class.
    It decrypts a private key using the algorithm specified in BIP38 without EC multiplication.
    """
    @staticmethod
    def Decrypt(priv_key_enc: str, passphrase: str) -> Tuple[bytes, Bip38PubKeyModes]:
        """
        Decrypt the specified private key.

        Args:
            priv_key_enc (str): Encrypted private key bytes
            passphrase (str)  : Passphrase

        Returns:
            tuple[bytes, Bip38PubKeyModes]: Decrypted private key (index 0), public key mode (index 1)

        Raises:
            Base58ChecksumError: If base58 checksum is not valid
            ValueError: If the encrypted key is not valid
        """
        ...
    


